# instant-io
Used to Trigger various kinds of IO on the given ceph Host.

To trigger any kind of IO, follow the following steps:
1. Install Python 3 using the command :
    * `yum install python3-pip -y`
2. Create a folder On the host were we need to run IO. CD to the dir.
3. Clone the instant-io repo using the command:
    * `git clone https://github.com/pdhiran/instant-io.git`
4. Setup a python3 virtual environment..
    * `python3 -m venv <path/to/venv>`
    * `source <path/to/venv>/bin/activate`
5. Install requirements with `pip install -r requirements.txt`
6. That's it!!!! Once you edit the config.json file as per your needs, you are good to go. All the sections that are set to ` "trigger": true` will be run on the host!!!!
7. To run the IO's using the script after the config changes, execute : `python3 instant-io.py`.

## Understanding the config file and editing it as per needs.

Config file is written in JSON format. It is very similar to the dictionary structure we use.

1. Set the logging parameter. Use "INFO" to get minimal details generated or use "DEBUG" to get maximum information about the runs. The log file is generated within the same folder with name log_IO_timestamp. Eg : log_IO_20200913090428.txt.

There are various sections in the json file like RGW, Rados_Bench, which indicate the various types of IO that can be run on the cluster.

###### RGW section
Various Params in the RGW section :
```
        "RGW":
          {
            "trigger": false,
            "rgw_host": "<IP/FQDN>",
            "create_rgw_user": false,
            "access_key": null,
            "secret_key": null,
            "num_buckets": 10,
            "num_objects": 10,
            "download_objects": true,
            "delete_buckets_and_objects": false
          },
 ```
1. `"trigger": true` -> when set to true, The script will proceed with triggering IO for RGW. It uses BOTO to trigger IO, creating objects. If you do not wish to trigger IO for RGW, set it to false.
2. `"rgw_host": "<IP/FQDN>"` -> Add the IP/ Fully qualified domain name of the node as a string
3. `"create_rgw_user": true` -> When set to "true", The script itself will create a RGW admin user for creating buckets and objects. All the Pre-Reqs like secret keys and access keys are generated by the script. When the parameter is set to "false", The script expects the RGW admin user to be already created and access key and secret key params to be set.
4. `"access_key": null` -> When param "create_rgw_user" is set to false, the script will require the access key of the RGW admin user. Provide the key like : `"access_key": "67890"`
5. `"secret_key": null` -> When param "create_rgw_user" is set to false, the script will require the secret key of the RGW admin user. Provide the key like : `"secret_key": "67890"`
6. `"num_buckets": 10` -> Specifies the number of Buckets to be created.
7. `"num_objects": 10` -> Specifies the number of objects to be created in each bucket. Eg num_buckets is 10 and num_objects is 10, total 100 Objects will be created. 10 objects each in a bucket.
8. `"download_objects": true` -> If true, the objects in all the buckets will be downloaded in the test folder under directory : object_downloads_<timestamp>. Eg : object_downloads_20200913090014
9. `"delete_buckets_and_objects": false` -> If set to true, deletes all the objects and buckets created by the user.


###### Rados_Bench section
Various Params in the Rados_Bench section :
```
        "Rados_Bench":
          {
            "trigger": false,
            "no_pools": 2,
            "write_seconds": 60,
            "Size": 4096,
            "sequential_read": true,
            "random_read": true,
            "read_seconds": 200,
            "delete_bench_data": false
          }
 ```
1. `"trigger": true` -> when set to true, The script will proceed with triggering IO for Rados. It uses Rados bench tool to trigger IO, creating objects. If you do not wish to trigger IO for Rados, set it to false.
2. `"no_pools": <no> -> Specifies the number of pools to be created. The below mentoned settings will be applied on all the pools created.
3. `"write_seconds": <secs>` -> Specifies the duration for which the Rados bench write opration will be performed on the pool.
4. `"Size": <bytes>` -> Specifies the size of the object being written.
5. `"sequential_read": true` -> If set to true, Performs Sequential read operation on the benchmark data written on the pool.
6. `"random_read": true` -> If set to true, Performs Random read operation on the benchmark data written on the pool.
7. `"read_seconds": 200` -> Specifies the duration for which the Read opration will be performed on the benchmark data written onto pool.
8. `"delete_bench_data": false` -> If set to true, deletes all the benchmark data written onto the pools created.

###### RBD section
Various Params in the RBD section :
```
    "RBD":
          {
            "trigger": false,
            "num_loops": 2,
            "num_parallel_jobs": 6,
            "block_size": "16k",
            "write_size": "512m",
            "run_time": 500,
            "delete_file_data": false
          }
 ```

1. `"trigger": true` -> when set to true, The script will proceed with triggering IO for RBD. It uses Rados FIO to trigger IO. If you do not wish to trigger IO, set it to false.
2. `"num_loops": 2,` -> Number of times the below IO config to be run the host
3. `"num_parallel_jobs": 6` -> Number of threads to be spawned on the host for running the IO of given size
4. `"block_size": "16k"` -> The block size in bytes used for I/O units.
5. `"write_size": "512m"` -> The total size of file I/O for each thread of the job.
6. `""run_time": 500` -> Tell fio to terminate processing after the specified period of time. It can be quite hard to determine for how long a specified job will run, so this parameter is handy to cap the total runtime to a given time.
7. `"delete_file_data": false` -> Instructs the Script to delete the data written 